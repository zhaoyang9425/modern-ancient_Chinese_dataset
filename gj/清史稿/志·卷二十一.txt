△推步算术
推步新法所用者，曰平三角形，曰弧三角形，曰椭圆形。今撮其大旨，证立法之原，验用数之实，都为一十六术，著于篇。
平三角形者，三直线相遇而成。其线为边，两线所夹空处为角。有正角，当全圆四分之一，如甲乙丙形之甲角。有锐角，不足四分之一，如乙、丙两角。有钝角，过四分之一，如丁戊己形之戊角。图形尚无资料
角之度无论多寡，皆有其相当之八线。曰正弦、正矢、正割、正切，所有度与九十度相减馀度之四线也，如甲乙为本度，则丙乙为馀度。正弦乙戊，正矢甲戊，正割庚丁，正切庚甲，馀弦乙己，馀矢丙己，馀割辛丁，馀切辛丙。若壬癸为本度，则丑癸为馀度，正弦癸辰，正矢壬辰，馀弦癸卯，馀矢丑卯，馀割子寅，馀切丑寅。以壬癸过九十度无正割、正切，借癸午之子未为正割，午未为正切。若正九十度丑壬为本度，则无馀度，丑子半径为正弦，壬子半径为正矢，亦无正割、正切，并无馀弦、馀矢、馀割、馀切。
古定全圆周为三百六十度，四分之一称一象限，为九十度。每度六十分，每分六十秒，每秒六十微。圆半径为十万，后改千万。逐度逐分求其八线，备列于表。推算三角，在九十度内，欲用某度某线，就表取之，算得某线。欲知某度，就表对之。过九十度者，欲用正弦、正割、正切及四馀，以其度与半周相减馀，就表取之。欲用正矢，取馀弦加半径为之。既得某线，欲知某度，就表对得其度与半周相减馀命之。
图形尚无资料
算平三角凡五术：
一曰对边求对角，以所知边为一率，对角正弦为二率，所知又一边为三率，二三相乘，一率除之，求得四率，为所不知之对角正弦。如图甲乙为所知边，丁角为所知对角，乙丁为所知又一边，甲角为所不知对角也。此其理系两次比例省为一次。如图乙丁为半径之比，乙丙为丁角正弦之比。法当先以半径为一率，丁角正弦为二率，乙丁为三率，求得四率中垂线乙丙。既得乙丙，甲乙为半径之比，乙丙又为甲角正弦之比。乃以甲乙为一率，乙丙为二率，半径为三率，求得四率，自为甲角正弦。然后合而算之，以先之一率半径与后之一率甲乙相乘为共一率，先之二率丁角正弦与后之二率乙丙相乘为共二率，先之三率乙丁与后之三率半径相乘为共三率，求得四率，自为先之四率乙丙与后之四率甲角正弦相乘数，仍当以乙丙除之，乃得甲角正弦。后既当除，不如先之勿乘。共二率内之乙丙与三率相乘者也，乘除相报，乙丙宜省。又共三率内之半径与二率相乘者也，共一率内之半径又主除之，乘除相报，半径又宜省。故径以甲乙为一率，丁角正弦为二率，乙丁为三率，求得四率，为甲角正弦。
二曰对角求对边，以所知角正弦为一率，对边为二率，所知又一角正弦为三率，求得四率，为所不知对边。此其理具对边求对角，反观自明。
三曰两边夹一角求不知之二角，以所知角旁两边相加为一率，相减馀为二率，所知角与半周相减，馀为外角，半之，取其正切为三率，求得四率，为半较角正切。对表得度，与半外角相加，为对所知角旁略大边之角；相减，馀为对所知角旁略小边之角。此其理一在平三角形。三角相并，必共成半周。如图甲乙丙形，中垂线甲丁，分为两正角形。正角为长方之半，长方四角皆正九十度，正角形两锐角斜剖长方，此角过九十度之半几何，彼角不足九十度之半亦几何，一线径过，其势然也。故甲右边分角必与乙角合为九十度，甲左边分角必与丙角合为九十度。论正角形各加丁角，皆成半周，合为锐角形。除去丁角，三角合亦自为半周。故既知一角之外，其馀二角虽不知各得几何度分，必知其共得此角减半周之馀也。一在三角同式形比例。如图丙庚戊形，知丙庚、丙戊两边及丙角。展丙庚为丙甲，连丙戊为甲戊，两边相加。截丙戊于丙丁，为戊丁，两边相减馀。作庚丁虚线，丙庚、丙丁同长，庚丁向圆内二角必同度，是皆为丙角之半外角，与甲辛、辛庚之度等。而庚向圆外之角，即本形庚角大于戊角之半，是为半外角。以庚丁为半径之比，则甲庚即为丁半外角正切之比。半径与正切恒为正角，甲庚与庚丁圆内作两通弦，亦无不成正角故也。又作丁己线，与甲庚平行，庚丁仍为半径之比，丁己又为庚向圆外半较角正切之比。而戊甲庚大形与戊丁己小形，戊甲、戊丁既在一线，甲庚、丁己又系平行，自然同式。故甲戊两边相加为一率，戊丁两边相减馀为二率，甲庚半外角正切为三率，求得四率，自当丁己半较角正切也。
四曰两角夹一边求不知之一角，以所知两角相并，与半周相减，馀即得。此其理具两边夹一角。
五曰三边求角，以大边为底，中、小二边相并相减，两数相乘，大边除之，得数与大边相加折半为分底大边，相减馀折半为分底小边。乃以中边为一率，分底大边为二率，半径为三率，求得四率，为对小边角馀弦。或以小边为一率，分底小边为二率，半径为三率，求得四率，为对中边角馀弦。此其理在勾股弦幂相求及两方幂相较。如图甲丙中边、甲乙小边皆为弦，乙丙大边由丁分之，丁丙、丁乙皆为勾，中垂线甲丁为股。勾股幂相并恒为弦幂，今甲丁股既两形所同，则甲丙大弦幂多于甲乙小弦幂，即同丙丁大勾幂多于乙丁小勾幂。又两方幂相较，恒如两方根和较相乘之数。如图戊寅壬庚为大方幂，减去己卯辛庚小方幂，馀戊己卯辛壬寅曲矩形。移卯癸壬辛为癸寅丑子，成一直方形，其长戊丑，自为大方根戊寅、小方根卯辛之和；其阔戊己，自为大方根戊庚、小方根己庚之较。故甲乙丙形，甲丙、甲乙相加为和，相减为较。两数相乘，即如丙丁、丁乙和较相乘之数。丙乙除之，自得其较。丙午相加相减各折半，自得丙丁及乙丁，既得丙丁、乙丁，各以丙甲、乙甲为半径之比，丙丁、乙丁自为馀弦之比矣。
此五术者，有四不待算，一不可算。对边求对角，令所知两边相等，则所求角与所知角必相等。对角求对边，令所知两角相等，则所求边与所知边必相等。两边夹一角，令所知两边相等，则所求二角必正得所知外角之半。三边求角，令二边相等，即分不等者之半为底边；三边相等，即平分半周三角皆六十度，皆不待算也。若对边求对角，所知一边数少，对所知一角锐；又所知一边数多，求所对之角，不能知其为锐、为钝，是不可算也。诸题求边角未尽者，互按得之。
弧三角形者，三圆周相遇而成，其边亦以度计。九十度为足，少于九十度为小，过九十度为大。其角锐、钝、正与平三角等。算术有七：
一曰对边求对角，以所知边正弦为一率，对角正弦为二率，所知又一边正弦为三率，求得四率，为所求对角正弦。此其理亦系两次比例省为一次。如图甲乙丙形，知甲乙、丙乙二边及丙角，求甲角。作乙辛垂弧，半径与丙角正弦之比，同于乙丙正弦与乙辛正弦之比。法当以半径为一率，丙角正弦为二率，乙丙正弦为三率，求得四率，为乙辛正弦。既得乙辛正弦，甲乙正弦与乙辛正弦之比，同于半径与甲角正弦之比。乃以甲乙正弦为一率，乙辛正弦为二率，半径为三率，求得四率，为甲角正弦。然乘除相报，可省省之。
二曰对角求对边，以所知角正弦为一率，对边正弦为二率，所知又一角正弦为三率，求得四率，为所求对边正弦。此其理反观自明。
三曰两边夹一角，或锐或钝，求不知之一边。以半径为一率，所知角馀弦为二率，任以所知一边正切为三率，求得四率，命为正切。对表得度，与所知又一边相减，馀为分边。乃以前得度馀弦为一率，先用边馀弦为二率，分边馀弦为三率，求得四率，为不知之边馀弦。原角钝，分边大，此边小；分边小，此边大。原角锐，分边小，此边小；分边大，此边大。此其理系三次比例省为二次。如图甲丙丁形，知甲丙、甲丁二边及甲角，中作垂弧丙乙，半径与甲角馀弦之比，同于甲丙正切与甲乙正切之比。先一算为易明。既分甲丁于乙，而得丁乙分边，甲乙馀弦与半径之比，同于甲丙馀弦与丙乙馀弦之比。法当先以甲乙馀弦为一率，半径为二率，甲丙馀弦为三率，求得四率，为丙乙馀弦。既得丙乙馀弦，半径与乙丁馀弦之比，同于丙乙馀弦与丁丙馀弦之比。乃以半径为一率，乙丁馀弦为二率，丙乙馀弦为三率，求得四率，为丁丙馀弦。然而乘除相报，故从省。两边夹一角若正，则径以所知两边馀弦相乘半径除之，即得不知边之馀弦，理自明也。所知两边俱大俱小，此边小；所知两边一小一大，此边大。
四曰两角夹一边，求不知之一角。以角为边，以边为角，反求之；得度，反取之；求、取皆与半周相减。
五曰所知两边对所知两角，或锐、或钝，求不知之边角。以半径为一率，任以所知一角之馀弦为二率，对所知又一角之边正切为三率，求得四率，命为正切，对表得度。复以所知又一角、一边如法求之，复得度。视原所知两角锐、钝相同，则两得度相加；不同，则两得度相减；皆加减为不知之边。乃按第一术对边求对角，即得不知之角。原又一角钝，对先用角之边大于后得度，此角钝；对先用角之边小于后得度，此角锐。原又一角锐，对先用角之边小于后得度，此角钝；对先用角之边大于后得度，此角锐。此其理系垂弧在形内与在形外之不同，及角分锐钝，边殊大小，前后左右俯仰向背之相应。如图甲乙丙形，甲乙二角俱锐，两锐相向，故垂弧丙丁，从中取正，而在形内。己丙庚形，己庚二角俱钝，两钝相向，故垂弧戊丙亦在形内。庚丙乙形，庚乙两角，一锐一钝相违，垂弧丙丁，从外补正，自在形外。在形内者判底边为二，两得分边之度，如乙丁、丁甲，合而成一底边如乙甲，故宜相加。在形外者，引底边之馀，两得分边之度，如庚丁、乙丁，重而不揜，底边如庚乙，故宜相减。锐钝大小之相应，亦如右图审之。所知两边对所知两角有一正，则一得度即为不知之边，理亦自明。
六曰三边求角，以所求角旁两边正弦相乘为一率，半径自乘为二率，两边相减馀为较弧，取其正矢与对边之正矢相减馀为三率，求得四率，为所求角正矢。此其理在两次比例省为一次。如图甲壬乙形，求甲角，其正矢为丑丁。法当以甲乙边正弦乙丙为一率，半径乙己为二率，两边较弧正矢乙癸与对边正矢乙卯相减馀癸卯同辛子为三率，求得四率为壬辛。乃以甲壬边正弦戊辛为一率，壬辛为二率，半径己丁为三率，求得四率为丑丁。甲角正矢亦以乘除相报，故从省焉。
七曰三角或锐、或钝求边，以角为边，反求其角；既得角，复取为边；求、取皆与半周相减。此其理在次形，如图甲乙丙形，甲角之度为丁戊，与半周相减为戊己，其度必同于次形子辛午之子辛边，盖丑卯为乙之角度丑点之交，甲乙弧必为正角，丁戊为甲之角度戊点之交，甲乙弧亦必为正角。以一甲乙而交丑辛、戊辛二弧皆成正角，则二弧必皆九十度，弧三角之势如此也。戊辛既九十度，子己亦九十度，去相覆之戊子，己戊自同子辛，于是庚癸必同子午，卯未必同午辛，理皆如是矣。而此形之馀角既皆为彼形之边，彼形馀角不得不为此形之边，故反取之而得焉。若三角有一正，除正角外，以一角之正弦为一率，又一角之馀弦为二率，半径为三率，求得四率，为对又一角之边馀弦。此其理亦系次形，而以正角及一角为次形之角，以又一角加减象限为次形对角之边，取象稍异。
凡兹七术，惟边角相求，有锐钝、大小不能定者，然推步无其题，不备列。此七题中求边角有未尽者，互按得之。
椭圆形者，两端径长、两腰径短之圆面。然必其应规，乃可推算。作之之术，任以两点各为心，一点为界，各用一针钉之，围以丝线，末以铅笔代为界之。针引而旋转，即成椭圆形。如图甲己午三点，如法作之，为丑午巳未椭圆，寅丑、寅巳为大半径，寅午、寅未为小半径，寅甲为两心差，己甲为倍两心差。甲午数如寅巳，亦同寅丑，己午如之；二数相和，恒与丑巳同。令午针引至申，甲申、申己长短虽殊，共数不易。甲午同大半径之数如弦，两心差如勾，小半径如股，但知两数，即可以勾股术得不知之一数。若求面积，以平方面率四００００００００为一率，平圆面率三一四一五九二六五为二率，大小径相乘成长方面为三率，求得四率为椭圆面积。若求中率半径，大小半径相乘，平方开之即得。然自甲心出线，离丑右旋，如图至戌，甲丑、甲戌之间，有所割之面积，亦有所当之角度。
角积相求，爰有四术：
一曰以角求积，以半径为一率，所知角度正弦为二率，倍两心差为三率，求得四率为倍两心差之端，垂线如己酉。又以半径为一率，所知角度馀弦为二率，倍两心差为三率，求得四率为界度积线，引出之线如甲酉，倍两心差之端垂线为勾自乘。以引出之线，与甲戌、己戌和如巳丑大径者相加为股弦和，除之得较。和、较相加折半为己戌弦，与大径相减为甲戌线。又以半径为一率，所知角正弦为二率，甲戌线为三率，求得四率为戌亥边。又以小径为一率，大径为二率，戌亥边为三率，求得四率为辰亥边。又以大半径寅辰同寅丑为一率，半径为二率，辰亥边为三率，求得四率为正弦，对表得度。又以半周天一百八十度化秒为一率，半圆周三一四一五九二六为二率，所得度化秒为三率，求得四率为比例弧线。又以半径为一率，大半径为二率，比例弧线为三率，求得四率为辰丑弧线，与大半径相乘折半，为寅辰丑分平圆面积。又以大半径为一率，小半径为二率，分平圆面积为三率，求得四率为寅戌丑分椭圆面积。乃以寅甲两心差与戌亥边相乘折半，与寅戌丑相减，为甲戌、甲丑之间所割面积。此其理具本图及平三角、弧三角，其法至密。
二曰以积求角，以两心差减大半径馀得甲丑线自乘为一率，中率半径自乘为二率，甲戌、甲丑之间面积为三率，求得四率为中率面积，如甲氐亢。分椭圆面积为三百六十度，取一度之面积为法除之，即得甲戌、甲丑之间所夹角度，此其理为同式形比例。然甲亢与甲氐同长，甲戌则长于甲丑，以所差不多，借为同数。若引戌至心，甲丑甲心所差实多，仍须用前法求甲戌线，借甲戌甲心相近为同数求之。
三曰借积求积，以所知面积，如图之辛甲丑，用一度之面积为法除之，得面积之度。设其度为角度，于倍两心差之端如庚己丑。以半径为一率，己角正弦为二率，倍两心差为三率，求得四率为甲子垂线。又以半径为一率，己角馀弦为二率，倍两心差为三率，求得四率为己子分边。甲子为勾自乘，己子与大径相减馀为股弦和，除之得股弦较。和、较相加折半得甲庚线。又以甲庚线为一率，甲子垂线为二率，半径为三率，求得四率为庚角正弦，得度与己角相加为庚甲丑角。乃用以角求积法，求得庚甲丑面积，与辛甲丑面积相减馀如庚甲辛，又用以积求角法，求得度，与庚甲丑角相加，即得辛甲丑角。
四曰借角求角，以所知面积如前法取为积度，如丑甲丁。设其度为角度，于椭圆心如丁乙辛。以小半径为一率，大半径为二率，所设角度正切为三率，求得四率为丁乙癸角正切。对表得度，乃于倍两心差之端丙作丙丑线，即命丑丙甲角如癸乙丁之角度，乃将丙丑线引长至寅，使丑寅与甲丑等，则丙寅同大径。又作甲寅线，成甲寅丙三角形，用切线分外角法求得寅角，倍之为甲丙丑形之丑角，与丙角相加为丑甲丁角。此其理癸乙甲角度多于丑甲丁积度，为子乙癸角度。即以此度当前之补算辛甲庚者，盖所差无多也。
此四术内凡单言半径者，皆八线表一千万之数。图形尚无资料
